import{u as P,d as E,r as i,Y as U,j as e,L,s as c,X as D,Z as F,z as u,_ as $,$ as M}from"./index-DpfGS3Ht.js";import{u as O,o as R,c as _,b as q,e as X,a as m}from"./index.esm-CuvX_hxC.js";import{T as Y}from"./Table-FvLzyYkS.js";import{M as Z}from"./Modal-9Na5SDL_.js";import{U as G,g as H}from"./apiConfig-BNRSSqnl.js";import{P as J}from"./plus-H8rF0gv1.js";import{P as K}from"./pen-BJKIaCD2.js";import{T as Q}from"./trash-2-Cjm8fSoJ.js";const V=_().shape({title:m().required("Title is required"),subtitle:m(),ctaText:m(),ctaLink:m(),priority:X().integer().min(0,"Priority must be positive"),isActive:q()}),ie=()=>{const l=P(),{banners:f,loading:b}=E(s=>s.banners),[B,x]=i.useState(!1),[a,y]=i.useState(null),[j,o]=i.useState(""),[v,p]=i.useState(null),{register:n,handleSubmit:A,formState:{errors:N},reset:w}=O({resolver:R(V)});i.useEffect(()=>{l(U())},[l]);const T=s=>{y(s),w({title:s.title,subtitle:s.subtitle||"",ctaText:s.ctaText||"",ctaLink:s.ctaLink||"",priority:s.priority||0,isActive:s.isActive!==!1}),o(s.image||""),x(!0)},k=async s=>{window.confirm("Are you sure you want to delete this banner?")&&(await l(F(s))).type==="banners/delete/fulfilled"&&u.success("Banner deleted successfully")},g=()=>{x(!1),y(null),o(""),p(null),w()},S=s=>{const t=s.target.files[0];if(t){p(t);const r=new FileReader;r.onloadend=()=>{o(r.result)},r.readAsDataURL(t)}},C=async s=>{const t=new FormData;t.append("image",s);try{const r=H();return(await(await fetch(`${r}/upload`,{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("adminToken")}`},body:t})).json()).imageUrl}catch(r){return console.error("Image upload failed:",r),null}},z=async s=>{try{let t=a?.image||"";if(v){const h=await C(v);if(h)t=h;else{u.error("Failed to upload image");return}}const r={...s,image:t};let d;a?d=await l($({id:a._id,bannerData:r})):d=await l(M(r)),d.type.includes("fulfilled")&&(u.success(a?"Banner updated successfully":"Banner created successfully"),g())}catch(t){console.error("Error saving banner:",t),u.error("Failed to save banner")}},I=[{header:"Image",accessor:"image",render:s=>e.jsx("img",{src:s.image||"/placeholder.png",alt:s.title,className:"w-32 h-20 object-cover rounded-lg"})},{header:"Title",accessor:"title"},{header:"Subtitle",accessor:"subtitle",render:s=>s.subtitle||"N/A"},{header:"CTA",accessor:"ctaText",render:s=>s.ctaText||"N/A"},{header:"Priority",accessor:"priority"},{header:"Status",accessor:"isActive",render:s=>e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${s.isActive?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:s.isActive?"Active":"Inactive"})}];return b&&!f.length?e.jsx(L,{fullScreen:!0}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:"Banners"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Manage homepage banners"})]}),e.jsx(c,{onClick:()=>x(!0),icon:e.jsx(J,{size:20}),children:"Add Banner"})]}),e.jsx(Y,{columns:I,data:f,actions:s=>e.jsxs(e.Fragment,{children:[e.jsx(c,{size:"sm",variant:"outline",onClick:()=>T(s),icon:e.jsx(K,{size:16}),children:"Edit"}),e.jsx(c,{size:"sm",variant:"danger",onClick:()=>k(s._id),icon:e.jsx(Q,{size:16}),children:"Delete"})]}),emptyMessage:"No banners found"}),e.jsx(Z,{isOpen:B,onClose:g,title:a?"Edit Banner":"Add New Banner",size:"lg",children:e.jsxs("form",{onSubmit:A(z),className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Banner Image *"}),e.jsxs("div",{className:"space-y-4",children:[j&&e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:j,alt:"Preview",className:"w-full h-48 object-cover rounded-lg"}),e.jsx("button",{type:"button",onClick:()=>{o(""),p(null)},className:"absolute top-2 right-2 p-2 bg-red-500 text-white rounded-full hover:bg-red-600",children:e.jsx(D,{size:16})})]}),e.jsxs("label",{className:"flex items-center justify-center gap-2 px-4 py-8 border-2 border-dashed border-gray-300 rounded-lg cursor-pointer hover:border-lavender-500 transition-colors",children:[e.jsx(G,{size:24,className:"text-gray-400"}),e.jsx("span",{className:"text-gray-600",children:"Upload Banner Image"}),e.jsx("input",{type:"file",accept:"image/*",onChange:S,className:"hidden"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Title *"}),e.jsx("input",{...n("title"),type:"text",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-lavender-500 focus:border-transparent",placeholder:"Enter banner title"}),N.title&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:N.title.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Subtitle"}),e.jsx("input",{...n("subtitle"),type:"text",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-lavender-500 focus:border-transparent",placeholder:"Enter subtitle"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"CTA Text"}),e.jsx("input",{...n("ctaText"),type:"text",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-lavender-500 focus:border-transparent",placeholder:"Shop Now"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"CTA Link"}),e.jsx("input",{...n("ctaLink"),type:"text",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-lavender-500 focus:border-transparent",placeholder:"/shop"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Display Priority"}),e.jsx("input",{...n("priority"),type:"number",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-lavender-500 focus:border-transparent",placeholder:"0"}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Lower numbers appear first"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{...n("isActive"),type:"checkbox",className:"w-4 h-4 text-lavender-600 border-gray-300 rounded focus:ring-lavender-500"}),e.jsx("label",{className:"text-sm text-gray-700",children:"Banner is active and visible on homepage"})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-200",children:[e.jsx(c,{type:"button",variant:"secondary",onClick:g,children:"Cancel"}),e.jsx(c,{type:"submit",loading:b,children:a?"Update Banner":"Create Banner"})]})]})})]})};export{ie as default};
