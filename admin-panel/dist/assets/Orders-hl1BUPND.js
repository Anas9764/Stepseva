import{u as ge,d as he,G as ye,r,I as v,J as W,z as n,j as e,L as be,X as fe,m as U,s as je,F as Ne}from"./index-DpfGS3Ht.js";import{T as ve}from"./Table-FvLzyYkS.js";import{u as L,w as Se,a as we,B as ke}from"./xlsx-BVpTWNsS.js";import{M as Ce}from"./Modal-9Na5SDL_.js";import{S as Ae}from"./SearchInput-CP9JsF7u.js";import{P as De}from"./Pagination-DItAE_xV.js";import{D as Pe}from"./download-B7t1c9JD.js";import{F as Ie}from"./filter-Ck4y10I1.js";import{E as Oe}from"./eye-B8aLYjqH.js";import{P as Te}from"./plus-H8rF0gv1.js";import"./circle-check-big-BLLBtyX0.js";import"./trash-2-Cjm8fSoJ.js";const Ve=()=>{const x=ge(),{orders:y,loading:X,pagination:j}=he(s=>s.orders),{markOrdersAsSeen:E,notificationItems:z,markAsRead:R}=ye(),[b,K]=r.useState(""),[u,Y]=r.useState("All"),[g,Z]=r.useState("All"),[p,B]=r.useState("All"),[i,S]=r.useState({start:"",end:""}),[d,w]=r.useState({min:"",max:""}),[t,M]=r.useState(null),[ee,G]=r.useState(!1),[k,_]=r.useState(1),[C,se]=r.useState(!1),[A,D]=r.useState(""),[J,P]=r.useState(""),[I,O]=r.useState(""),[T,Q]=r.useState(!1),[V,F]=r.useState(!1),[c,q]=r.useState([]),[Fe,H]=r.useState(!1),$=10,N=()=>{const s="http://localhost:5000/api";return s.endsWith("/")?s.slice(0,-1):s};r.useEffect(()=>{_(1)},[u,g,p,i,d,b]),r.useEffect(()=>{const s={};u!=="All"&&(s.status=u),g!=="All"&&(s.paymentType=g),p!=="All"&&(s.paymentStatus=p),i.start&&(s.startDate=i.start),i.end&&(s.endDate=i.end),d.min&&(s.minAmount=d.min),d.max&&(s.maxAmount=d.max),b&&(s.search=b),s.page=k,s.limit=$,x(v(s))},[x,u,g,p,i,d,b,k,$]),r.useEffect(()=>{E(),z.filter(s=>s.type==="order"&&!s.read).forEach(s=>R(s.id))},[E,z,R]);const f=y,te=j?.pages||1,ae=s=>{_(s)},re=async(s,a)=>{(await x(W({id:s,status:a}))).type==="orders/updateStatus/fulfilled"&&n.success("Order status updated successfully")},ne=s=>{M(s),D(s.trackingNumber||""),P(s.carrier||""),G(!0)},le=async s=>{try{const a=N(),o=await fetch(`${a}/orders/${s}/invoice`,{headers:{Authorization:`Bearer ${localStorage.getItem("adminToken")}`}});if(o.ok){const l=await o.blob(),h=window.URL.createObjectURL(l),m=document.createElement("a");m.href=h,m.download=`invoice-${s}.pdf`,document.body.appendChild(m),m.click(),window.URL.revokeObjectURL(h),document.body.removeChild(m),n.success("Invoice downloaded successfully")}else n.error("Failed to download invoice")}catch(a){console.error("Invoice download error:",a),n.error("Failed to download invoice")}},ie=async()=>{try{const s=new URLSearchParams;u!=="All"&&s.append("status",u),g!=="All"&&s.append("paymentType",g),p!=="All"&&s.append("paymentStatus",p),i.start&&s.append("startDate",i.start),i.end&&s.append("endDate",i.end);const a=N(),o=await fetch(`${a}/orders/export/csv?${s.toString()}`,{headers:{Authorization:`Bearer ${localStorage.getItem("adminToken")}`}});if(o.ok){const l=await o.blob(),h=window.URL.createObjectURL(l),m=document.createElement("a");m.href=h,m.download=`orders-export-${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(m),m.click(),window.URL.revokeObjectURL(h),document.body.removeChild(m),n.success("Orders exported successfully")}else n.error("Failed to export orders")}catch(s){console.error("Export error:",s),n.error("Failed to export orders")}},oe=async()=>{if(!A.trim()){n.error("Please enter a tracking number");return}try{const s=N(),a=await fetch(`${s}/orders/${t._id}/tracking`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("adminToken")}`},body:JSON.stringify({trackingNumber:A,carrier:J})});if(a.ok){n.success("Tracking information updated successfully"),Q(!1),D(""),P(""),x(v());const o=await a.json();M(o.data)}else n.error("Failed to update tracking information")}catch(s){console.error("Tracking update error:",s),n.error("Failed to update tracking information")}},de=async()=>{if(!I.trim()){n.error("Please enter a note");return}try{const s=N();(await fetch(`${s}/orders/${t._id}/notes`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("adminToken")}`},body:JSON.stringify({note:I,isInternal:!0})})).ok?(n.success("Note added successfully"),O(""),F(!1),x(v())):n.error("Failed to add note")}catch(s){console.error("Add note error:",s),n.error("Failed to add note")}},ce=r.useCallback((s,a)=>{q(s)},[]),me=r.useCallback(async s=>{if(c.length!==0){H(!0);try{let a=0,o=0;for(const l of c)try{(await x(W({id:l._id,status:s}))).type==="orders/updateStatus/fulfilled"?a++:o++}catch{o++}a>0&&n.success(`Successfully updated ${a} order(s) to ${s}`),o>0&&n.error(`Failed to update ${o} order(s)`),q([]),x(v())}catch{n.error("Bulk status update failed")}finally{H(!1)}}},[c,x]),xe=r.useCallback(()=>{if(c.length===0){n.error("No orders selected");return}try{const s=c.map(l=>({"Order ID":l.orderId||l._id?.slice(-6).toUpperCase(),"Customer Name":l.user?.name||"Guest","Customer Email":l.user?.email||l.email||"N/A",Phone:l.phone||"N/A","Total Amount":l.totalAmount||0,Status:l.status||"Pending","Payment Status":l.paymentStatus||"Pending","Payment Type":l.paymentType==="cod"?"COD":"Online","Items Count":l.items?.length||0,"Order Date":l.createdAt?new Date(l.createdAt).toLocaleDateString():"N/A","Shipping Address":l.shippingAddress?`${l.shippingAddress.address}, ${l.shippingAddress.city}, ${l.shippingAddress.state}`:"N/A"})),a=L.json_to_sheet(s),o=L.book_new();L.book_append_sheet(o,a,"Orders"),Se(o,`orders-export-${Date.now()}.xlsx`),n.success(`Exported ${c.length} order(s) to Excel`)}catch(s){console.error("Export error:",s),n.error("Failed to export orders")}},[c]),pe=r.useCallback(()=>{if(c.length===0){n.error("No orders selected");return}try{we(c),n.success(`Exported ${c.length} order(s) to PDF`)}catch(s){console.error("PDF export error:",s),n.error("Failed to export orders to PDF")}},[c]),ue=[{header:"Order ID",accessor:"_id",render:s=>e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium",children:["#",s.orderId||s._id?.slice(-6).toUpperCase()]}),e.jsx("p",{className:"text-xs text-gray-500",children:s._id?.slice(-6).toUpperCase()})]})},{header:"Customer",accessor:"user",render:s=>e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:s.user?.name||"Guest"}),e.jsx("p",{className:"text-xs text-gray-500",children:s.user?.email})]})},{header:"Items",accessor:"items",render:s=>s.items?.length||0},{header:"Total",accessor:"totalAmount",render:s=>e.jsx("div",{children:e.jsxs("p",{className:"font-semibold text-gray-800",children:["₹",s.totalAmount?.toLocaleString("en-IN")]})})},{header:"Payment",accessor:"paymentStatus",render:s=>e.jsxs("div",{className:"space-y-1",children:[e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium block ${s.paymentStatus==="Paid"?"bg-green-100 text-green-800":s.paymentStatus==="pending"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"}`,children:s.paymentStatus||"Pending"}),e.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-medium block ${s.paymentType==="cod"?"bg-blue-100 text-blue-800":"bg-purple-100 text-purple-800"}`,children:s.paymentType==="cod"?"COD":"Online"})]})},{header:"Status",accessor:"status",render:s=>e.jsxs("select",{value:s.status,onChange:a=>re(s._id,a.target.value),className:`px-3 py-1 rounded-lg text-xs font-medium border-0 focus:ring-2 focus:ring-lavender-500 ${s.status==="delivered"?"bg-green-100 text-green-800":s.status==="shipped"?"bg-blue-100 text-blue-800":s.status==="processing"||s.status==="confirmed"?"bg-yellow-100 text-yellow-800":s.status==="cancelled"?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"}`,children:[e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"confirmed",children:"Confirmed"}),e.jsx("option",{value:"processing",children:"Processing"}),e.jsx("option",{value:"shipped",children:"Shipped"}),e.jsx("option",{value:"delivered",children:"Delivered"}),e.jsx("option",{value:"cancelled",children:"Cancelled"})]})},{header:"Date",accessor:"createdAt",render:s=>new Date(s.createdAt).toLocaleDateString()}];return X&&!y.length?e.jsx(be,{fullScreen:!0}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:"Orders Management"}),e.jsxs("p",{className:"text-gray-600 mt-1",children:["Manage customer orders • ",j?.total||f.length," ",(j?.total||f.length)===1?"order":"orders"," found"]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("button",{onClick:ie,className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors font-semibold",children:[e.jsx(Pe,{size:18}),"Export CSV"]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Last Updated"}),e.jsx("p",{className:"text-sm font-semibold text-gray-800",children:new Date().toLocaleTimeString("en-IN")})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow p-4 border-l-4 border-blue-500",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Total Orders"}),e.jsx("p",{className:"text-2xl font-bold text-gray-800",children:y.length})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-4 border-l-4 border-yellow-500",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Pending"}),e.jsx("p",{className:"text-2xl font-bold text-gray-800",children:y.filter(s=>s.status==="pending"||s.status==="confirmed"||s.status==="processing").length})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-4 border-l-4 border-green-500",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Delivered"}),e.jsx("p",{className:"text-2xl font-bold text-gray-800",children:y.filter(s=>s.status==="delivered").length})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-4 border-l-4 border-purple-500",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Total Revenue"}),e.jsxs("p",{className:"text-2xl font-bold text-gray-800",children:["₹",y.reduce((s,a)=>s+(a.totalAmount||0),0).toLocaleString("en-IN")]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-4 mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Filters"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>se(!C),className:"flex items-center gap-2 px-3 py-1.5 rounded-lg text-sm font-medium bg-gray-100 text-gray-700 hover:bg-gray-200 transition-colors",children:[e.jsx(Ie,{size:16}),C?"Hide":"Show"," Advanced"]}),(i.start||i.end||d.min||d.max||p!=="All")&&e.jsxs("button",{onClick:()=>{S({start:"",end:""}),w({min:"",max:""}),B("All")},className:"flex items-center gap-2 px-3 py-1.5 rounded-lg text-sm font-medium bg-red-100 text-red-700 hover:bg-red-200 transition-colors",children:[e.jsx(fe,{size:16}),"Clear Advanced"]})]})]}),e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsx(Ae,{value:b,onChange:K,placeholder:"Search by order ID, customer name, email, or phone..."})}),e.jsxs("div",{className:"flex flex-wrap gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Order Status"}),e.jsx("div",{className:"flex gap-2 flex-wrap",children:["All","pending","confirmed","processing","shipped","delivered","cancelled"].map(s=>e.jsx("button",{onClick:()=>Y(s),className:`px-3 py-1.5 rounded-lg text-xs font-medium transition-colors capitalize ${u===s?"bg-gradient-to-r from-pink-light to-lavender-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:s},s))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Payment Type"}),e.jsx("div",{className:"flex gap-2",children:["All","cod","online"].map(s=>e.jsx("button",{onClick:()=>Z(s),className:`px-3 py-1.5 rounded-lg text-xs font-medium transition-colors capitalize ${g===s?"bg-gradient-to-r from-blue-500 to-purple-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:s==="cod"?"COD":s==="online"?"Online":s},s))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Payment Status"}),e.jsx("div",{className:"flex gap-2",children:["All","paid","pending","failed","refunded"].map(s=>e.jsx("button",{onClick:()=>B(s),className:`px-3 py-1.5 rounded-lg text-xs font-medium transition-colors capitalize ${p===s?"bg-gradient-to-r from-green-500 to-emerald-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:s},s))})]})]}),C&&e.jsx(U.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"border-t pt-4 mt-4 space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Date Range"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"date",value:i.start,onChange:s=>S({...i,start:s.target.value}),className:"px-3 py-1.5 rounded-lg text-xs border border-gray-300 focus:ring-2 focus:ring-primary focus:border-transparent"}),e.jsx("input",{type:"date",value:i.end,onChange:s=>S({...i,end:s.target.value}),className:"px-3 py-1.5 rounded-lg text-xs border border-gray-300 focus:ring-2 focus:ring-primary focus:border-transparent"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Amount Range (₹)"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"number",placeholder:"Min",value:d.min,onChange:s=>w({...d,min:s.target.value}),className:"px-3 py-1.5 rounded-lg text-xs border border-gray-300 focus:ring-2 focus:ring-primary focus:border-transparent w-full"}),e.jsx("input",{type:"number",placeholder:"Max",value:d.max,onChange:s=>w({...d,max:s.target.value}),className:"px-3 py-1.5 rounded-lg text-xs border border-gray-300 focus:ring-2 focus:ring-primary focus:border-transparent w-full"})]})]})]})})]})]}),e.jsx(ke,{selectedCount:c.length,onBulkStatusUpdate:me,onBulkExport:xe,onBulkExportPDF:pe,showDelete:!1,showStatusUpdate:!0,showExport:!0,showExportPDF:!0,availableStatuses:[{value:"Pending",label:"Pending"},{value:"Processing",label:"Processing"},{value:"Shipped",label:"Shipped"},{value:"Delivered",label:"Delivered"},{value:"Cancelled",label:"Cancelled"}]}),e.jsx(ve,{columns:ue,data:f,enableBulkSelection:!0,onSelectionChange:ce,getRowId:s=>s._id,actions:s=>e.jsx(je,{size:"sm",variant:"outline",onClick:()=>ne(s),icon:e.jsx(Oe,{size:16}),children:"View"}),emptyMessage:"No orders found"}),f.length>0&&e.jsx(De,{currentPage:k,totalPages:te,onPageChange:ae,itemsPerPage:$,totalItems:j?.total||f.length,showInfo:!0,align:"right"}),t&&e.jsx(Ce,{isOpen:ee,onClose:()=>G(!1),title:`Order #${t.orderId||t._id?.slice(-6).toUpperCase()}`,size:"lg",children:e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-gradient-to-r from-pink-light to-lavender-500 rounded-lg p-4 text-white",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm opacity-90",children:"Order ID"}),e.jsx("p",{className:"text-xl font-bold",children:t.orderId||t._id?.slice(-6).toUpperCase()})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm opacity-90",children:"Total Amount"}),e.jsxs("p",{className:"text-xl font-bold",children:["₹",t.totalAmount?.toLocaleString("en-IN")]})]})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Order Status"}),e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium inline-block ${t.status==="delivered"?"bg-green-100 text-green-800":t.status==="shipped"?"bg-blue-100 text-blue-800":t.status==="processing"||t.status==="confirmed"?"bg-yellow-100 text-yellow-800":t.status==="cancelled"?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"}`,children:t.status?.charAt(0).toUpperCase()+t.status?.slice(1)||"Pending"})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Payment"}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium block ${t.paymentStatus==="Paid"?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:t.paymentStatus||"Pending"}),e.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-medium block ${t.paymentType==="cod"?"bg-blue-100 text-blue-800":"bg-purple-100 text-purple-800"}`,children:t.paymentType==="cod"?"Cash on Delivery":"Online Payment"})]})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-semibold text-gray-800 mb-3",children:"Customer Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500",children:"Name"}),e.jsx("p",{className:"font-medium",children:t.user?.name||"Guest"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500",children:"Email"}),e.jsx("p",{className:"font-medium",children:t.user?.email||t.email||"N/A"})]}),t.phone&&e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500",children:"Phone"}),e.jsx("p",{className:"font-medium",children:t.phone})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500",children:"Order Date"}),e.jsx("p",{className:"font-medium",children:new Date(t.createdAt).toLocaleString("en-IN")})]})]})]}),t.shippingAddress&&e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Shipping Address"}),e.jsxs("p",{className:"text-sm text-gray-700",children:[t.shippingAddress.firstName," ",t.shippingAddress.lastName,e.jsx("br",{}),t.shippingAddress.address,e.jsx("br",{}),t.shippingAddress.city,", ",t.shippingAddress.state," ",t.shippingAddress.zipCode,e.jsx("br",{}),t.shippingAddress.country]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-800 mb-3",children:"Order Items"}),e.jsx("div",{className:"space-y-3",children:t.items?.map((s,a)=>e.jsxs(U.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:a*.1},className:"flex items-center gap-4 p-3 bg-gray-50 rounded-lg",children:[e.jsx("img",{src:s.product?.image||"/placeholder.png",alt:s.product?.name,className:"w-16 h-16 object-cover rounded-lg"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium",children:s.product?.name}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Qty: ",s.quantity," × ₹",s.price?.toLocaleString("en-IN"),s.size&&` • Size: ${s.size}`]})]}),e.jsxs("p",{className:"font-semibold",children:["₹",(s.quantity*s.price).toLocaleString("en-IN")]})]},a))})]}),e.jsx("div",{className:"border-t pt-4",children:e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Subtotal"}),e.jsxs("span",{className:"font-medium",children:["₹",t.subtotal?.toLocaleString("en-IN")]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Shipping"}),e.jsxs("span",{className:"font-medium",children:["₹",t.shippingCost?.toLocaleString("en-IN")||"0"]})]}),t.discount>0&&e.jsxs("div",{className:"flex justify-between text-green-600",children:[e.jsx("span",{children:"Discount"}),e.jsxs("span",{className:"font-medium",children:["-₹",t.discount?.toLocaleString("en-IN")]})]}),e.jsxs("div",{className:"flex justify-between text-lg font-bold pt-2 border-t",children:[e.jsx("span",{children:"Total"}),e.jsxs("span",{children:["₹",t.totalAmount?.toLocaleString("en-IN")]})]})]})}),e.jsxs("div",{className:"bg-blue-50 rounded-lg p-4 border border-blue-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"font-semibold text-gray-800",children:"Tracking Information"}),e.jsx("button",{onClick:()=>Q(!T),className:"text-sm text-blue-600 hover:text-blue-800 font-medium",children:T?"Cancel":t.trackingNumber?"Update":"Add"})]}),t.trackingNumber?e.jsxs("div",{className:"space-y-2",children:[e.jsxs("p",{className:"text-sm",children:[e.jsx("strong",{children:"Tracking Number:"})," ",t.trackingNumber]}),t.carrier&&e.jsxs("p",{className:"text-sm",children:[e.jsx("strong",{children:"Carrier:"})," ",t.carrier]}),t.estimatedDelivery&&e.jsxs("p",{className:"text-sm",children:[e.jsx("strong",{children:"Estimated Delivery:"})," ",new Date(t.estimatedDelivery).toLocaleDateString("en-IN")]})]}):e.jsx("p",{className:"text-sm text-gray-600",children:"No tracking information added yet"}),T&&e.jsxs("div",{className:"mt-4 space-y-3",children:[e.jsx("input",{type:"text",placeholder:"Tracking Number",value:A,onChange:s=>D(s.target.value),className:"w-full px-3 py-2 rounded-lg border border-gray-300 focus:ring-2 focus:ring-primary focus:border-transparent"}),e.jsx("input",{type:"text",placeholder:"Carrier (e.g., FedEx, DHL, India Post)",value:J,onChange:s=>P(s.target.value),className:"w-full px-3 py-2 rounded-lg border border-gray-300 focus:ring-2 focus:ring-primary focus:border-transparent"}),e.jsx("button",{onClick:oe,className:"w-full px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-semibold",children:"Update Tracking"})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"font-semibold text-gray-800",children:"Order Notes"}),e.jsxs("button",{onClick:()=>F(!V),className:"flex items-center gap-1 text-sm text-primary hover:text-secondary font-medium",children:[e.jsx(Te,{size:16}),"Add Note"]})]}),V&&e.jsxs("div",{className:"mb-4 space-y-2",children:[e.jsx("textarea",{placeholder:"Add internal note about this order...",value:I,onChange:s=>O(s.target.value),className:"w-full px-3 py-2 rounded-lg border border-gray-300 focus:ring-2 focus:ring-primary focus:border-transparent",rows:3}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:de,className:"px-4 py-2 bg-primary text-white rounded-lg hover:bg-secondary transition-colors font-semibold text-sm",children:"Save Note"}),e.jsx("button",{onClick:()=>{F(!1),O("")},className:"px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors font-semibold text-sm",children:"Cancel"})]})]}),t.notes&&t.notes.length>0?e.jsx("div",{className:"space-y-2 max-h-40 overflow-y-auto",children:t.notes.map((s,a)=>e.jsxs("div",{className:"bg-white p-3 rounded-lg border border-gray-200",children:[e.jsx("p",{className:"text-sm text-gray-700",children:s.note}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[new Date(s.createdAt).toLocaleString("en-IN")," • ",s.isInternal?"Internal":"Customer"]})]},a))}):e.jsx("p",{className:"text-sm text-gray-600",children:"No notes added yet"})]}),t.orderTimeline&&t.orderTimeline.length>0&&e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-800 mb-3",children:"Order Timeline"}),e.jsx("div",{className:"space-y-3",children:t.orderTimeline.slice().sort((s,a)=>new Date(a.timestamp)-new Date(s.timestamp)).map((s,a)=>e.jsxs(U.div,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{delay:a*.1},className:"flex items-start gap-3 p-3 bg-gray-50 rounded-lg",children:[e.jsx("div",{className:"flex-shrink-0 w-2 h-2 bg-primary rounded-full mt-2"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-gray-800",children:s.status.charAt(0).toUpperCase()+s.status.slice(1).replace("_"," ")}),s.note&&e.jsx("p",{className:"text-xs text-gray-600 mt-1",children:s.note}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:new Date(s.timestamp).toLocaleString("en-IN")})]})]},a))})]}),e.jsx("div",{className:"flex gap-3 pt-4 border-t",children:e.jsxs("button",{onClick:()=>le(t._id),className:"flex-1 flex items-center justify-center gap-2 px-4 py-2 bg-primary text-white rounded-lg hover:bg-secondary transition-colors font-semibold",children:[e.jsx(Ne,{size:18}),"Download Invoice"]})})]})})]})};export{Ve as default};
