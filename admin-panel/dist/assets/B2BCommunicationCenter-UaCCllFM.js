import{r as t,j as e,s as r,L as w,O as m,p as u,ac as C,W as z,ad as L}from"./index-DrVHF49k.js";import{T as S}from"./Table-CPTOpXxD.js";import{S as A}from"./SearchInput-DQh0A_yT.js";import{F as k}from"./filter-DjuklAPT.js";import{M as h}from"./mail-DxZXcYW2.js";const M=()=>{const[c,p]=t.useState([]),[y,o]=t.useState(!1),[l,j]=t.useState(""),[i,g]=t.useState(""),[n,f]=t.useState("");t.useEffect(()=>{(async()=>{try{o(!0);const a={limit:200};l&&(a.status=l),i&&(a.priority=i),n&&(a.search=n);const x=await C.getAllLeads(a),b=x?.data||x;p(b?.leads||[])}catch(a){console.error("Error fetching leads for communication center:",a)}finally{o(!1)}})()},[l,i,n]);const d=t.useMemo(()=>c,[c]),v=s=>s?new Date(s).toLocaleString("en-IN",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A",N=[{header:"Buyer",render:s=>e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-9 h-9 rounded-full bg-primary/10 flex items-center justify-center",children:e.jsx(z,{size:18,className:"text-primary"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold text-gray-900",children:s.buyerName}),s.companyName&&e.jsx("p",{className:"text-xs text-gray-600",children:s.companyName}),e.jsx("p",{className:"text-xs text-gray-500 capitalize",children:s.businessType?.replace("_"," ")})]})]})},{header:"Contact",render:s=>e.jsxs("div",{className:"text-sm space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-1 text-gray-700",children:[e.jsx(u,{size:12}),e.jsx("span",{children:s.buyerPhone})]}),e.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-600",children:[e.jsx(h,{size:12}),e.jsx("span",{className:"truncate max-w-[180px]",title:s.buyerEmail,children:s.buyerEmail})]})]})},{header:"Product / Inquiry",render:s=>e.jsxs("div",{className:"text-sm",children:[e.jsx("p",{className:"font-medium text-gray-900 truncate max-w-[220px]",title:s.productName,children:s.productName}),e.jsxs("p",{className:"text-xs text-gray-500",children:["Qty: ",s.quantityRequired," â€¢ Type:"," ",s.inquiryType?.replace("_"," ")]})]})},{header:"Last Activity",render:s=>e.jsxs("div",{className:"text-xs text-gray-700",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(L,{size:12}),e.jsx("span",{children:s.lastContactedAt?"Last contacted":s.contactedAt?"First contact":"Created"})]}),e.jsx("p",{className:"mt-1",children:v(s.lastContactedAt||s.contactedAt||s.createdAt)})]})}];return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Communication Center"}),e.jsx("p",{className:"mt-1 text-sm text-gray-600",children:"Central place to see who to contact next and through which channel."})]})}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md border border-gray-200 space-y-4",children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsx(A,{value:n,onChange:f,placeholder:"Search by buyer, email, phone, or company..."})}),e.jsxs("div",{className:"flex items-center gap-2 text-gray-700 text-sm",children:[e.jsx(k,{size:16}),e.jsx("span",{children:"Quick filters"})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Status"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:[{value:"",label:"All"},{value:"new",label:"New"},{value:"contacted",label:"Contacted"},{value:"interested",label:"Interested"},{value:"quoted",label:"Quoted"},{value:"negotiating",label:"Negotiating"},{value:"closed",label:"Closed"}].map(s=>e.jsx(r,{size:"sm",variant:l===s.value?"primary":"secondary",onClick:()=>j(s.value),children:s.label},s.value||"all"))})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Priority"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:[{value:"",label:"All"},{value:"urgent",label:"Urgent"},{value:"high",label:"High"},{value:"medium",label:"Medium"},{value:"low",label:"Low"}].map(s=>e.jsx(r,{size:"sm",variant:i===s.value?"primary":"secondary",onClick:()=>g(s.value),children:s.label},s.value||"all"))})]})]})]}),e.jsx("div",{className:"bg-white rounded-lg shadow-md border border-gray-200",children:y?e.jsx(w,{}):d.length===0?e.jsxs("div",{className:"p-12 text-center",children:[e.jsx(m,{className:"mx-auto text-gray-400 mb-4",size:48}),e.jsx("p",{className:"text-gray-600",children:"No leads found for the selected filters."})]}):e.jsx(S,{columns:N,data:d,actions:s=>e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(r,{size:"sm",variant:"success",onClick:()=>window.open(`tel:${s.buyerPhone}`,"_blank"),children:[e.jsx(u,{size:14}),"Call"]}),e.jsxs(r,{size:"sm",variant:"outline",onClick:()=>window.open(`https://wa.me/${s.buyerPhone}?text=Hi%20${encodeURIComponent(s.buyerName||"")}%2C%20regarding%20your%20inquiry%20for%20${encodeURIComponent(s.productName||"our products")}`,"_blank"),children:[e.jsx(m,{size:14}),"WhatsApp"]}),e.jsxs(r,{size:"sm",variant:"secondary",onClick:()=>window.open(`mailto:${s.buyerEmail}`,"_blank"),children:[e.jsx(h,{size:14}),"Email"]})]}),emptyMessage:"No leads found"})})]})};export{M as default};
